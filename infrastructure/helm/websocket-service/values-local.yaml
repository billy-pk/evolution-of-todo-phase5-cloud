# Local Minikube values for websocket-service
# Overrides values.yaml for local development

image:
  pullPolicy: Never  # Use local Docker images from Minikube
  tag: "latest"

# Service configuration
service:
  type: ClusterIP  # Use port-forwarding in WSL (NodePort doesn't work well)
  port: 8005
  targetPort: 8005

# Dapr sidecar configuration
dapr:
  enabled: true
  appId: websocket-service
  appPort: 8005
  appProtocol: http
  enableMetrics: true
  metricsPort: 9090
  logLevel: debug

# Environment variables for local development
env:
  DATABASE_URL: ""  # Set via --set-string during helm install
  DAPR_HTTP_PORT: "3500"
  DAPR_GRPC_PORT: "50001"
  LOG_LEVEL: "debug"

# ConfigMap for application configuration
configMap:
  enabled: true
  data:
    APP_NAME: "websocket-service"
    ENVIRONMENT: "local"
    DAPR_PUBSUB_NAME: "pubsub"

# Resource limits for local development (reduced)
resources:
  limits:
    cpu: 300m
    memory: 256Mi
  requests:
    cpu: 50m
    memory: 128Mi

# Security context
securityContext:
  fsGroup: 1000

# Pod annotations (Dapr sidecar injection)
podAnnotations:
  dapr.io/enabled: "true"
  dapr.io/app-id: "websocket-service"
  dapr.io/app-port: "8005"
  dapr.io/app-protocol: "http"
  dapr.io/enable-metrics: "true"
  dapr.io/metrics-port: "9090"
  dapr.io/log-level: "debug"
